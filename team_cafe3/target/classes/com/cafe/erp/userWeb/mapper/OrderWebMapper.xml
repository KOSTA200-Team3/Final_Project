<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cafe.erp.userWeb.model.OrderWebDAO">
<!--
	public int getOrderWebCount(int customer_code);				//해당 고객의 총 주문 음료수 가져오기
	public int getOrderWebTotal(int customer_code);				//해당 고객의 총 주문 금액 가져오기
	public void insertOrderWeb(OrderWebDTO dto);				//주문테이블에 저장
	
	public int getOrderWebRecent();								//주문테이블의 가장 최근 코드값 가져오기
	public void insertOrderWebList(HashMap map);			//주문내역테이블에저장
	public List<ProductCartAddDTO> getProductCartAddList();		//장바귀 옵션내역 테이블 가져오기
	
		
-->


	<select id="getOrderWebCount" parameterType="int"  resultType="Integer" >
		 select sum(cart_num) from cafe_cart where customer_code=#{customer_code}
 	</select>

	<select id="getOrderWebTotal" parameterType="int"  resultType="Integer" >
		 select sum(order_web_total) from(
				select a.cart_num , b.cafe_product_price , a.cart_num*b.cafe_product_price order_web_total 
				from CAFE_CART a, CAFE_PRODUCT b where a.cafe_product_code=b.cafe_product_code and customer_code=#{customer_code})
 	</select>

	<insert id="insertOrderWeb" parameterType="com.cafe.erp.userWeb.model.OrderWebDTO">
		insert into CAFE_ORDER_WEB(order_web_code,order_web_total,order_web_count,order_web_date,customer_code) values((select NVL(max(order_web_code), 0)+1 from CAFE_ORDER_WEB),#{order_web_total},#{order_web_count},sysdate,#{customer_code})	
	</insert>
	
	<insert id="insertOrderWebList" parameterType="hashmap">
		insert into CAFE_ORDERList_web(orderList_web_code,cafe_product_code,orderList_web_count,order_web_code) values((select NVL(max(orderList_web_code), 0)+1 from CAFE_ORDERList_web),#{cartdto.cafe_product_code},#{cartdto.cart_num},#{order_web_code})	
	</insert>

	<select id="getOrderWebRecent" resultType="Integer" >
		  select max(order_web_code) from CAFE_ORDER_WEB
 	</select>

	<select id="getProductCartAddList" resultType="com.cafe.erp.userWeb.model.ProductCartAddDTO"  >
		  select * FROM CAFE_CART_ADD order by cart_code,PRODUCT_ADD_CODE
 	</select>
</mapper>